---
import UnderPageLayout from "@layouts/UnderPageLayout.astro";
---

<UnderPageLayout
  mainLabel="CONTACT"
  subLabel="お問い合わせ"
  title="お問い合わせ"
>
  <div class="mx-auto max-w-4xl space-y-8">
    <!-- お問い合わせフォーム -->
    <div class="rounded-subtle border border-gray-100 bg-white p-6 md:p-8 shadow-lg -mx-6 md:mx-0">
      <div class="mb-6 text-center">
        <h2 class="mb-4 text-2xl font-bold text-main leading-[0.9] md:leading-[0.95]">お問い合わせフォーム</h2>
        <p class="text-gray-600">
          ご質問やご相談がございましたら、お気軽にお問い合わせください。
        </p>
      </div>
      
      <!-- iframeでフォームを埋め込み -->
      <div class="w-full">


        <iframe
          id="contact-form-iframe"
          src="https://joyzo.form.kintoneapp.com/public/corp-contact?iframe=true"
          width="100%"
          height="1140"
          frameborder="0"
          class="rounded-lg"
          title="お問い合わせフォーム"
        >
        </iframe>
      </div>
    </div>

    
  </div>
</UnderPageLayout>

<script>
  // iFrameの高さを動的に調整する関数
  function adjustIframeHeight() {
    const iframe = document.getElementById('contact-form-iframe') as HTMLIFrameElement;
    if (!iframe) return;

    // iFrameが読み込まれた後に実行
    iframe.onload = function() {
      try {
        // iFrame内のコンテンツの高さを取得
        const iframeDocument = iframe.contentDocument || iframe.contentWindow?.document;
        const body = iframeDocument?.body;
        const html = iframeDocument?.documentElement;
        
        if (body && html) {
          // コンテンツの実際の高さを計算
          const height = Math.max(
            body.scrollHeight,
            body.offsetHeight,
            html.clientHeight,
            html.scrollHeight,
            html.offsetHeight
          );
          
          // iFrameの高さを調整（最小800px、最大2000px）
          const adjustedHeight = Math.max(800, Math.min(height + 50, 2000));
          iframe.style.height = adjustedHeight + 'px';
        }
      } catch (error) {
        // クロスオリジンエラーの場合はデフォルトの高さを維持
        console.log('iFrameの高さ調整でクロスオリジンエラーが発生しました。デフォルトの高さを維持します。');
      }
    };

    // ページ読み込み時に実行
    if (iframe.contentDocument && iframe.contentDocument.readyState === 'complete') {
      iframe.onload?.();
    }
  }

  // DOMが読み込まれた後に実行
  document.addEventListener('DOMContentLoaded', () => adjustIframeHeight());
  
  // ページが完全に読み込まれた後にも実行（フォールバック）
  window.addEventListener('load', () => adjustIframeHeight());
</script>