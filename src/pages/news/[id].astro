---
import type { KintoneNews } from "src/types/kintone/news";

import UnderPageLayout from "@layouts/UnderPageLayout.astro";
import { getNewsList, getNewsDetail } from "@libs/kintone";
import NewsBody from "@components/pages/news/NewsBody.svelte";
import { processContent } from "src/utils/processContent";

export const getStaticPaths = async () => {
  const { contents: news } = await getNewsList(1, 100);

  return news.map((news) => ({ params: { id: news.id } }));
};

const { id } = Astro.params;
if (!id) throw new Error("id is required");

const content = await getNewsDetail(id);

if (content.content) {
  content.content = processContent(content.content);
}
---

<UnderPageLayout mainLabel="NEWS" subLabel="お知らせ" title="お知らせ">
  <NewsBody content={content} />
</UnderPageLayout>
